<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="neteja_i_preparacio_files/libs/clipboard/clipboard.min.js"></script>
<script src="neteja_i_preparacio_files/libs/quarto-html/tabby.min.js"></script>
<script src="neteja_i_preparacio_files/libs/quarto-html/popper.min.js"></script>
<script src="neteja_i_preparacio_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="neteja_i_preparacio_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="neteja_i_preparacio_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="neteja_i_preparacio_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.26">

  <title>Neteja i preparació de les dades</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="neteja_i_preparacio_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="neteja_i_preparacio_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="neteja_i_preparacio_files/libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="styles.css">
  <link href="neteja_i_preparacio_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="neteja_i_preparacio_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="neteja_i_preparacio_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="neteja_i_preparacio_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Neteja i preparació de les dades</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="percentatge-de-valors-perduts-dataset-final" class="slide level2">
<h2>Percentatge de valors perduts (dataset final)</h2>

<img data-src="neteja_i_preparacio_files/figure-revealjs/cell-3-output-1.png" class="r-stretch"></section>
<section id="les-10-provinces-amb-major-percentatge-de-vot-imputat" class="slide level2">
<h2>Les 10 provinces amb major percentatge de vot imputat</h2>

<img data-src="neteja_i_preparacio_files/figure-revealjs/cell-12-output-1.png" class="r-stretch"></section>
<section id="imputació-del-vot-per-provincia-i-any" class="slide level2">
<h2>Imputació del vot per provincia i any</h2>
<div id="b046932e" class="cell" data-fig-width="11" data-fig-height="6.2" data-fig-dpi="200" data-execution_count="63">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="neteja_i_preparacio_files/figure-revealjs/cell-13-output-1.png"></p>
</figure>
</div>
</div>
</div>
<div id="6a169a14" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="neteja_i_preparacio_files/figure-revealjs/cell-16-output-1.png"></p>
</figure>
</div>
</div>
</div>
<div id="8769a584" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">n_missing</th>
<th data-quarto-table-cell-role="th">pct_missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>immigracio</td>
<td>104</td>
<td>8.70</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>immigracio_per100k</td>
<td>104</td>
<td>8.70</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>feminicidis_per100k</td>
<td>52</td>
<td>4.35</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>atur_annual_mean_pct</td>
<td>52</td>
<td>4.35</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>province</td>
<td>52</td>
<td>4.35</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>unemployed_per100k</td>
<td>52</td>
<td>4.35</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>unemployed_est</td>
<td>52</td>
<td>4.35</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>denuncies</td>
<td>52</td>
<td>4.35</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>denuncies_per100k</td>
<td>52</td>
<td>4.35</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>ordres</td>
<td>52</td>
<td>4.35</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="029ffd26" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">votes_edreta</th>
<th data-quarto-table-cell-role="th">source_file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2000</td>
<td>Almeria</td>
<td>278462</td>
<td>487</td>
<td>Vots extrema dreta 2000.xlsx</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2000</td>
<td>Cadiz</td>
<td>553667</td>
<td>1001</td>
<td>Vots extrema dreta 2000.xlsx</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2000</td>
<td>Cordoba</td>
<td>461695</td>
<td>419</td>
<td>Vots extrema dreta 2000.xlsx</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2000</td>
<td>Granada</td>
<td>480242</td>
<td>378</td>
<td>Vots extrema dreta 2000.xlsx</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2000</td>
<td>Huelva</td>
<td>245452</td>
<td>311</td>
<td>Vots extrema dreta 2000.xlsx</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape: (364, 5)
Columns: ['year', 'province', 'total_votes', 'votes_edreta', 'source_file']</code></pre>
</div>
</div>
<div id="ae368bae" class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>Backup creat: C:\Users\bfeli\3 BBDD inicials\originals\Excels\Eleccions\merged_votes_edreta.bak.csv
Columns abans: ['year', 'province', 'total_votes', 'votes_edreta', 'source_file']
Columna 'source_file' eliminada.
Fitxer guardat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\Eleccions\merged_votes_edreta.csv
Variable 'merged' actualitzada. Composició: (364, 4)</code></pre>
</div>
</div>
<div id="979bb6c1" class="cell" data-execution_count="18">
<div class="cell-output cell-output-stdout">
<pre><code>Fitxer processat: Denuncies.xlsx
Files input: 22 Files output: 1144
Parcial desat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\Denuncies_long.csv</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">source_file</th>
<th data-quarto-table-cell-role="th">metric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2003</td>
<td>Almeria</td>
<td>12780.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2004</td>
<td>Almeria</td>
<td>13770.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2005</td>
<td>Almeria</td>
<td>10490.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2006</td>
<td>Almeria</td>
<td>26660.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2007</td>
<td>Almeria</td>
<td>22980.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>2008</td>
<td>Almeria</td>
<td>24810.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>2009</td>
<td>Almeria</td>
<td>26040.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>2010</td>
<td>Almeria</td>
<td>27520.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>2011</td>
<td>Almeria</td>
<td>23570.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>2012</td>
<td>Almeria</td>
<td>21230.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>2013</td>
<td>Almeria</td>
<td>20790.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>2014</td>
<td>Almeria</td>
<td>20840.0</td>
<td>Denuncies.xlsx</td>
<td>denuncies</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Processant: Denuncies.xlsx
 OK -&gt; partial: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\Denuncies_long.csv

--- Processant: Ordres.xlsx
 OK -&gt; partial: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\Ordres_long.csv

Informe desat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\process_report_individuals.csv</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">file</th>
<th data-quarto-table-cell-role="th">rows_input</th>
<th data-quarto-table-cell-role="th">cols_input</th>
<th data-quarto-table-cell-role="th">rows_output</th>
<th data-quarto-table-cell-role="th">metric</th>
<th data-quarto-table-cell-role="th">drop_meta_cols</th>
<th data-quarto-table-cell-role="th">partial_saved</th>
<th data-quarto-table-cell-role="th">partial_shape</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Denuncies.xlsx</td>
<td>22</td>
<td>53</td>
<td>1144</td>
<td>denuncies</td>
<td>True</td>
<td>C:\Users\bfeli\3 BBDD inicials\originals\Excel...</td>
<td>(1144, 3)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Ordres.xlsx</td>
<td>22</td>
<td>53</td>
<td>1144</td>
<td>ordres</td>
<td>True</td>
<td>C:\Users\bfeli\3 BBDD inicials\originals\Excel...</td>
<td>(1144, 3)</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parcials dir: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals existeix: True
Parcials arxius (mostra): ['Denuncies_long.csv', 'FE_denuncies_per100k_votes_params.csv', 'FE_feminicidis_per100k_votes_params.csv', 'FE_ordres_per100k_votes_params.csv', 'Ordres_long.csv', 'atur_annual_by_province_unweighted.csv', 'atur_annual_unweighted.csv', 'dataset_imputed_bayes.csv', 'dataset_locf_2024.csv', 'dataset_no2000.csv', 'dataset_no2000_no2024.csv', 'dataset_original.csv', 'debug_pop_atur_merge_sample.csv', 'denuncies_results.csv', 'feminicidis_long.csv', 'feminicidis_results.csv', 'forest_combined_votes_per100k_table.csv', 'immigracio_long.csv', 'imputed_interp_somevars.csv', 'imputed_iterative_rates_all_metrics_by_province_year_unified_final_recomputed_rates.csv', 'imputed_rates_all_metrics_by_province_year_unified_final_recomputed_rates.csv', 'inspect_summary.csv', 'missing_pct_overall.csv', 'missing_summary_chosen_file.csv', 'ordres_results.csv', 'percent_change_2023_2024_immigracio.csv', 'poblacio_long.csv', 'population_imputed_linear.csv', 'population_imputed_linear_with_province.csv', 'population_imputed_national_growth.csv', 'preview_top1_dataset_locf_2024_csv.csv', 'preview_top1_rates_all_metrics_by_province_year_unified_final_recomputed_rates_csv.csv', 'preview_top2_dataset_original_csv.csv', 'preview_top2_rates_all_metrics_by_province_year_unified_fixed_csv.csv', 'preview_top3_processed_dataset_original_csv.csv', 'preview_top3_rates_all_metrics_by_province_year_unified_fixed_voteslocf_csv.csv', 'process_report_individuals.csv', 'processed_dataset_no2000.csv', 'processed_dataset_no2024.csv', 'processed_dataset_original.csv']
\Vista de Denuncies_long.csv</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2003</td>
<td>Almeria</td>
<td>12780.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2004</td>
<td>Almeria</td>
<td>13770.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2005</td>
<td>Almeria</td>
<td>10490.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2006</td>
<td>Almeria</td>
<td>26660.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2007</td>
<td>Almeria</td>
<td>22980.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>2008</td>
<td>Almeria</td>
<td>24810.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>2009</td>
<td>Almeria</td>
<td>26040.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>2010</td>
<td>Almeria</td>
<td>27520.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>2011</td>
<td>Almeria</td>
<td>23570.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>2012</td>
<td>Almeria</td>
<td>21230.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>2013</td>
<td>Almeria</td>
<td>20790.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>2014</td>
<td>Almeria</td>
<td>20840.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="3c784697" class="cell" data-execution_count="19">
<div class="cell-output cell-output-stdout">
<pre><code>File: C:\Users\bfeli\3 BBDD inicials\originals\Excels\feminicidis.xlsx

Vista prèvia (header=None) (primeres 12 files):</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
<th data-quarto-table-cell-role="th">21</th>
<th data-quarto-table-cell-role="th">22</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Provincia</td>
<td>2003</td>
<td>2004</td>
<td>2005</td>
<td>2006</td>
<td>2007</td>
<td>2008</td>
<td>2009</td>
<td>2010</td>
<td>2011</td>
<td>2012</td>
<td>2013</td>
<td>2014</td>
<td>2015</td>
<td>2016</td>
<td>2017</td>
<td>2018</td>
<td>2019</td>
<td>2020</td>
<td>2021</td>
<td>2022</td>
<td>2023</td>
<td>2024</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Almeria</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>5</td>
<td>6</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Cadiz</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Cordoba</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Granada</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>5</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Huelva</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Jaen</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Malaga</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>4</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>4</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Sevilla</td>
<td>2</td>
<td>4</td>
<td>2</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>2</td>
<td>4</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>4</td>
<td>3</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Huesca</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Teruel</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Zaragoza</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
capçalera=0 -&gt; comptador columnes: 23; detectades year-columnes (mostra): ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010']
  mostra columnes (primeres 12): ['Provincia', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013']</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Provincia</th>
<th data-quarto-table-cell-role="th">2003</th>
<th data-quarto-table-cell-role="th">2004</th>
<th data-quarto-table-cell-role="th">2005</th>
<th data-quarto-table-cell-role="th">2006</th>
<th data-quarto-table-cell-role="th">2007</th>
<th data-quarto-table-cell-role="th">2008</th>
<th data-quarto-table-cell-role="th">2009</th>
<th data-quarto-table-cell-role="th">2010</th>
<th data-quarto-table-cell-role="th">2011</th>
<th data-quarto-table-cell-role="th">2012</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">2022</th>
<th data-quarto-table-cell-role="th">2023</th>
<th data-quarto-table-cell-role="th">2024</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Almeria</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>5</td>
<td>6</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Cadiz</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Cordoba</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Granada</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>5</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
capçalera=1 -&gt; comptador columnes: 23; detectades year-columnes (mostra): []
  mostra columnes (primeres 12): ['Almeria', 1, 2, '2.1', 3, '1.1', '1.2', '3.1', 5, 6, 0, '1.3']</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Almeria</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">2.1</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">1.1</th>
<th data-quarto-table-cell-role="th">1.2</th>
<th data-quarto-table-cell-role="th">3.1</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1.3</th>
<th data-quarto-table-cell-role="th">2.2</th>
<th data-quarto-table-cell-role="th">2.3</th>
<th data-quarto-table-cell-role="th">0.1</th>
<th data-quarto-table-cell-role="th">3.2</th>
<th data-quarto-table-cell-role="th">2.4</th>
<th data-quarto-table-cell-role="th">1.4</th>
<th data-quarto-table-cell-role="th">0.2</th>
<th data-quarto-table-cell-role="th">1.5</th>
<th data-quarto-table-cell-role="th">1.6</th>
<th data-quarto-table-cell-role="th">1.7</th>
<th data-quarto-table-cell-role="th">2.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Cadiz</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Cordoba</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Granada</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>5</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Huelva</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
capçalera=2 -&gt; comptador columnes: 23; detectades year-columnes (mostra): []
  mostra columnes (primeres 12): ['Cadiz', 3, '3.1', 0, 1, '0.1', '3.2', '1.1', '1.2', '1.3', '0.2', '1.4']</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Cadiz</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">3.1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">0.1</th>
<th data-quarto-table-cell-role="th">3.2</th>
<th data-quarto-table-cell-role="th">1.1</th>
<th data-quarto-table-cell-role="th">1.2</th>
<th data-quarto-table-cell-role="th">1.3</th>
<th data-quarto-table-cell-role="th">0.2</th>
<th data-quarto-table-cell-role="th">1.4</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">0.3</th>
<th data-quarto-table-cell-role="th">0.4</th>
<th data-quarto-table-cell-role="th">0.5</th>
<th data-quarto-table-cell-role="th">0.6</th>
<th data-quarto-table-cell-role="th">1.5</th>
<th data-quarto-table-cell-role="th">3.3</th>
<th data-quarto-table-cell-role="th">2.1</th>
<th data-quarto-table-cell-role="th">0.7</th>
<th data-quarto-table-cell-role="th">3.4</th>
<th data-quarto-table-cell-role="th">0.8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Cordoba</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Granada</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>5</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Huelva</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Jaen</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
capçalera=3 -&gt; comptador columnes: 23; detectades year-columnes (mostra): []
  mostra columnes (primeres 12): ['Cordoba', 1, 4, '1.1', 2, '1.2', '1.3', '1.4', '1.5', '1.6', 0, '2.1']</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Cordoba</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">1.1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">1.2</th>
<th data-quarto-table-cell-role="th">1.3</th>
<th data-quarto-table-cell-role="th">1.4</th>
<th data-quarto-table-cell-role="th">1.5</th>
<th data-quarto-table-cell-role="th">1.6</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">2.1</th>
<th data-quarto-table-cell-role="th">1.7</th>
<th data-quarto-table-cell-role="th">1.8</th>
<th data-quarto-table-cell-role="th">0.1</th>
<th data-quarto-table-cell-role="th">0.2</th>
<th data-quarto-table-cell-role="th">0.3</th>
<th data-quarto-table-cell-role="th">4.1</th>
<th data-quarto-table-cell-role="th">1.9</th>
<th data-quarto-table-cell-role="th">0.4</th>
<th data-quarto-table-cell-role="th">1.10</th>
<th data-quarto-table-cell-role="th">1.11</th>
<th data-quarto-table-cell-role="th">0.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Granada</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>5</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Huelva</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Jaen</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Malaga</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>4</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>4</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Utilitzant province_col = Provincia
Mostra year-columnes: ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012']
Parcial desat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\feminicidis_long.csv
Estructura de la sortida: (1144, 3)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Almeria</td>
<td>2003</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Cadiz</td>
<td>2003</td>
<td>3</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Cordoba</td>
<td>2003</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Granada</td>
<td>2003</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Huelva</td>
<td>2003</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Jaen</td>
<td>2003</td>
<td>3</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Malaga</td>
<td>2003</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Sevilla</td>
<td>2003</td>
<td>2</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Huesca</td>
<td>2003</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Teruel</td>
<td>2003</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Zaragoza</td>
<td>2003</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Asturias</td>
<td>2003</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Estructura: (1144, 3)
Years mostra: ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012']
Provinces mostra (primeres 10): ['A Coruña', 'Alacant', 'Albacete', 'Almeria', 'Araba', 'Asturias', 'Avila', 'Badajoz', 'Barcelona', 'Bizkaia']
Valors perduts a 'value': 0</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1132</th>
<td>Lugo</td>
<td>2024</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1133</th>
<td>Ourense</td>
<td>2024</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1134</th>
<td>Pontevedra</td>
<td>2024</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1135</th>
<td>Madrid</td>
<td>2024</td>
<td>4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1136</th>
<td>Murcia</td>
<td>2024</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1137</th>
<td>Navarra</td>
<td>2024</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1138</th>
<td>Araba</td>
<td>2024</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1139</th>
<td>Bizkaia</td>
<td>2024</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1140</th>
<td>Gipuzkoa</td>
<td>2024</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1141</th>
<td>La Rioja</td>
<td>2024</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1142</th>
<td>Ceuta</td>
<td>2024</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1143</th>
<td>Melilla</td>
<td>2024</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="092ef9ef" class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>Lectura: C:\Users\bfeli\3 BBDD inicials\originals\Excels\immigracio.xlsx
Utilitzant province_col = Provincia
Mostra year columnes: ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012']
Parcial desat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\immigracio_long.csv
Estructura de sortida: (1092, 3)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Albacete</td>
<td>2003</td>
<td>13318</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Alacant</td>
<td>2003</td>
<td>245883</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Almeria</td>
<td>2003</td>
<td>56276</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Araba</td>
<td>2003</td>
<td>10445</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Asturias</td>
<td>2003</td>
<td>19691</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Avila</td>
<td>2003</td>
<td>3514</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Badajoz</td>
<td>2003</td>
<td>7167</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Illes Balears</td>
<td>2003</td>
<td>126505</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Barcelona</td>
<td>2003</td>
<td>398459</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Bizkaia</td>
<td>2003</td>
<td>23908</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Burgos</td>
<td>2003</td>
<td>10908</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Caceres</td>
<td>2003</td>
<td>10718</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e9381d68" class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>Arxiu: C:\Users\bfeli\3 BBDD inicials\originals\Excels\poblacio.xlsx

Vista (header=None) prèvia (primeres 8 files):</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
<th data-quarto-table-cell-role="th">21</th>
<th data-quarto-table-cell-role="th">22</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Provincia</td>
<td>2024</td>
<td>2023</td>
<td>2022</td>
<td>2021</td>
<td>2020</td>
<td>2019</td>
<td>2018</td>
<td>2017</td>
<td>2016</td>
<td>2015</td>
<td>2014</td>
<td>2013</td>
<td>2012</td>
<td>2011</td>
<td>2010</td>
<td>2009</td>
<td>2008</td>
<td>2007</td>
<td>2006</td>
<td>2005</td>
<td>2004</td>
<td>2003</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Albacete</td>
<td>389070</td>
<td>387529</td>
<td>385967</td>
<td>386726</td>
<td>387838</td>
<td>387818</td>
<td>388948</td>
<td>390225</td>
<td>391865</td>
<td>394012</td>
<td>396017</td>
<td>399093</td>
<td>401590</td>
<td>400847</td>
<td>399448</td>
<td>397881</td>
<td>394521</td>
<td>389127</td>
<td>383458</td>
<td>379276</td>
<td>374717</td>
<td>370383</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Alacant</td>
<td>1993289</td>
<td>1955268</td>
<td>1907494</td>
<td>1887036</td>
<td>1877627</td>
<td>1855384</td>
<td>1839319</td>
<td>1836715</td>
<td>1837873</td>
<td>1838578</td>
<td>1848236</td>
<td>1852733</td>
<td>1853209</td>
<td>1844439</td>
<td>1840085</td>
<td>1836134</td>
<td>1817519</td>
<td>1766320</td>
<td>1713934</td>
<td>1661660</td>
<td>1602174</td>
<td>1542318</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Almeria</td>
<td>760964</td>
<td>753364</td>
<td>739541</td>
<td>730430</td>
<td>724003</td>
<td>714123</td>
<td>707319</td>
<td>704871</td>
<td>700055</td>
<td>694051</td>
<td>690750</td>
<td>692434</td>
<td>689320</td>
<td>686448</td>
<td>680484</td>
<td>673042</td>
<td>659443</td>
<td>642797</td>
<td>627719</td>
<td>603215</td>
<td>577427</td>
<td>560655</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Araba</td>
<td>338594</td>
<td>336308</td>
<td>333908</td>
<td>333485</td>
<td>332874</td>
<td>330104</td>
<td>327763</td>
<td>325250</td>
<td>322974</td>
<td>321541</td>
<td>320451</td>
<td>320199</td>
<td>320566</td>
<td>319846</td>
<td>317737</td>
<td>315280</td>
<td>310944</td>
<td>306475</td>
<td>302481</td>
<td>298830</td>
<td>294304</td>
<td>290746</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Asturias</td>
<td>1009599</td>
<td>1006060</td>
<td>1004960</td>
<td>1012117</td>
<td>1018053</td>
<td>1021469</td>
<td>1027091</td>
<td>1033550</td>
<td>1040407</td>
<td>1049328</td>
<td>1058560</td>
<td>1067425</td>
<td>1074304</td>
<td>1075877</td>
<td>1077103</td>
<td>1076280</td>
<td>1071081</td>
<td>1065291</td>
<td>1063488</td>
<td>1062755</td>
<td>1062408</td>
<td>1062320</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Avila</td>
<td>160463</td>
<td>159764</td>
<td>159102</td>
<td>158898</td>
<td>158819</td>
<td>159237</td>
<td>160104</td>
<td>161782</td>
<td>163669</td>
<td>165694</td>
<td>167265</td>
<td>169373</td>
<td>171365</td>
<td>172771</td>
<td>173370</td>
<td>173818</td>
<td>173290</td>
<td>170206</td>
<td>167950</td>
<td>166166</td>
<td>164651</td>
<td>163549</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Badajoz</td>
<td>666029</td>
<td>666049</td>
<td>667851</td>
<td>671092</td>
<td>672045</td>
<td>673384</td>
<td>675742</td>
<td>679042</td>
<td>682970</td>
<td>686250</td>
<td>688697</td>
<td>690889</td>
<td>691842</td>
<td>689902</td>
<td>687745</td>
<td>684391</td>
<td>680675</td>
<td>674169</td>
<td>668510</td>
<td>664407</td>
<td>659640</td>
<td>656228</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
capçalera=0 -&gt; columnes comptador: 23; detectades year-columns mostra: [2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010]
Mostra de columnes (primeres 12): ['Provincia', 2024, 2023, 2022, 2021, 2020, 2019, 2018, 2017, 2016, 2015, 2014]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Provincia</th>
<th data-quarto-table-cell-role="th">2024</th>
<th data-quarto-table-cell-role="th">2023</th>
<th data-quarto-table-cell-role="th">2022</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2012</th>
<th data-quarto-table-cell-role="th">2011</th>
<th data-quarto-table-cell-role="th">2010</th>
<th data-quarto-table-cell-role="th">2009</th>
<th data-quarto-table-cell-role="th">2008</th>
<th data-quarto-table-cell-role="th">2007</th>
<th data-quarto-table-cell-role="th">2006</th>
<th data-quarto-table-cell-role="th">2005</th>
<th data-quarto-table-cell-role="th">2004</th>
<th data-quarto-table-cell-role="th">2003</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Albacete</td>
<td>389070</td>
<td>387529</td>
<td>385967</td>
<td>386726</td>
<td>387838</td>
<td>387818</td>
<td>388948</td>
<td>390225</td>
<td>391865</td>
<td>394012</td>
<td>396017</td>
<td>399093</td>
<td>401590</td>
<td>400847</td>
<td>399448</td>
<td>397881</td>
<td>394521</td>
<td>389127</td>
<td>383458</td>
<td>379276</td>
<td>374717</td>
<td>370383</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Alacant</td>
<td>1993289</td>
<td>1955268</td>
<td>1907494</td>
<td>1887036</td>
<td>1877627</td>
<td>1855384</td>
<td>1839319</td>
<td>1836715</td>
<td>1837873</td>
<td>1838578</td>
<td>1848236</td>
<td>1852733</td>
<td>1853209</td>
<td>1844439</td>
<td>1840085</td>
<td>1836134</td>
<td>1817519</td>
<td>1766320</td>
<td>1713934</td>
<td>1661660</td>
<td>1602174</td>
<td>1542318</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Almeria</td>
<td>760964</td>
<td>753364</td>
<td>739541</td>
<td>730430</td>
<td>724003</td>
<td>714123</td>
<td>707319</td>
<td>704871</td>
<td>700055</td>
<td>694051</td>
<td>690750</td>
<td>692434</td>
<td>689320</td>
<td>686448</td>
<td>680484</td>
<td>673042</td>
<td>659443</td>
<td>642797</td>
<td>627719</td>
<td>603215</td>
<td>577427</td>
<td>560655</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
capçalera=1 -&gt; columnes comptador: 23; detectades year-columns mostra: []
Mostra de columnes (primeres 12): ['Albacete', 389070, 387529, 385967, 386726, 387838, 387818, 388948, 390225, 391865, 394012, 396017]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Albacete</th>
<th data-quarto-table-cell-role="th">389070</th>
<th data-quarto-table-cell-role="th">387529</th>
<th data-quarto-table-cell-role="th">385967</th>
<th data-quarto-table-cell-role="th">386726</th>
<th data-quarto-table-cell-role="th">387838</th>
<th data-quarto-table-cell-role="th">387818</th>
<th data-quarto-table-cell-role="th">388948</th>
<th data-quarto-table-cell-role="th">390225</th>
<th data-quarto-table-cell-role="th">391865</th>
<th data-quarto-table-cell-role="th">394012</th>
<th data-quarto-table-cell-role="th">396017</th>
<th data-quarto-table-cell-role="th">399093</th>
<th data-quarto-table-cell-role="th">401590</th>
<th data-quarto-table-cell-role="th">400847</th>
<th data-quarto-table-cell-role="th">399448</th>
<th data-quarto-table-cell-role="th">397881</th>
<th data-quarto-table-cell-role="th">394521</th>
<th data-quarto-table-cell-role="th">389127</th>
<th data-quarto-table-cell-role="th">383458</th>
<th data-quarto-table-cell-role="th">379276</th>
<th data-quarto-table-cell-role="th">374717</th>
<th data-quarto-table-cell-role="th">370383</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Alacant</td>
<td>1993289</td>
<td>1955268</td>
<td>1907494</td>
<td>1887036</td>
<td>1877627</td>
<td>1855384</td>
<td>1839319</td>
<td>1836715</td>
<td>1837873</td>
<td>1838578</td>
<td>1848236</td>
<td>1852733</td>
<td>1853209</td>
<td>1844439</td>
<td>1840085</td>
<td>1836134</td>
<td>1817519</td>
<td>1766320</td>
<td>1713934</td>
<td>1661660</td>
<td>1602174</td>
<td>1542318</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Almeria</td>
<td>760964</td>
<td>753364</td>
<td>739541</td>
<td>730430</td>
<td>724003</td>
<td>714123</td>
<td>707319</td>
<td>704871</td>
<td>700055</td>
<td>694051</td>
<td>690750</td>
<td>692434</td>
<td>689320</td>
<td>686448</td>
<td>680484</td>
<td>673042</td>
<td>659443</td>
<td>642797</td>
<td>627719</td>
<td>603215</td>
<td>577427</td>
<td>560655</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Araba</td>
<td>338594</td>
<td>336308</td>
<td>333908</td>
<td>333485</td>
<td>332874</td>
<td>330104</td>
<td>327763</td>
<td>325250</td>
<td>322974</td>
<td>321541</td>
<td>320451</td>
<td>320199</td>
<td>320566</td>
<td>319846</td>
<td>317737</td>
<td>315280</td>
<td>310944</td>
<td>306475</td>
<td>302481</td>
<td>298830</td>
<td>294304</td>
<td>290746</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
capçalera=2 -&gt; columnes comptador: 23; detectades year-columns mostra: [1907494, 1955268, 1993289]
Mostra de columnes (primeres 12): ['Alacant', 1993289, 1955268, 1907494, 1887036, 1877627, 1855384, 1839319, 1836715, 1837873, 1838578, 1848236]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Alacant</th>
<th data-quarto-table-cell-role="th">1993289</th>
<th data-quarto-table-cell-role="th">1955268</th>
<th data-quarto-table-cell-role="th">1907494</th>
<th data-quarto-table-cell-role="th">1887036</th>
<th data-quarto-table-cell-role="th">1877627</th>
<th data-quarto-table-cell-role="th">1855384</th>
<th data-quarto-table-cell-role="th">1839319</th>
<th data-quarto-table-cell-role="th">1836715</th>
<th data-quarto-table-cell-role="th">1837873</th>
<th data-quarto-table-cell-role="th">1838578</th>
<th data-quarto-table-cell-role="th">1848236</th>
<th data-quarto-table-cell-role="th">1852733</th>
<th data-quarto-table-cell-role="th">1853209</th>
<th data-quarto-table-cell-role="th">1844439</th>
<th data-quarto-table-cell-role="th">1840085</th>
<th data-quarto-table-cell-role="th">1836134</th>
<th data-quarto-table-cell-role="th">1817519</th>
<th data-quarto-table-cell-role="th">1766320</th>
<th data-quarto-table-cell-role="th">1713934</th>
<th data-quarto-table-cell-role="th">1661660</th>
<th data-quarto-table-cell-role="th">1602174</th>
<th data-quarto-table-cell-role="th">1542318</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Almeria</td>
<td>760964</td>
<td>753364</td>
<td>739541</td>
<td>730430</td>
<td>724003</td>
<td>714123</td>
<td>707319</td>
<td>704871</td>
<td>700055</td>
<td>694051</td>
<td>690750</td>
<td>692434</td>
<td>689320</td>
<td>686448</td>
<td>680484</td>
<td>673042</td>
<td>659443</td>
<td>642797</td>
<td>627719</td>
<td>603215</td>
<td>577427</td>
<td>560655</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Araba</td>
<td>338594</td>
<td>336308</td>
<td>333908</td>
<td>333485</td>
<td>332874</td>
<td>330104</td>
<td>327763</td>
<td>325250</td>
<td>322974</td>
<td>321541</td>
<td>320451</td>
<td>320199</td>
<td>320566</td>
<td>319846</td>
<td>317737</td>
<td>315280</td>
<td>310944</td>
<td>306475</td>
<td>302481</td>
<td>298830</td>
<td>294304</td>
<td>290746</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Asturias</td>
<td>1009599</td>
<td>1006060</td>
<td>1004960</td>
<td>1012117</td>
<td>1018053</td>
<td>1021469</td>
<td>1027091</td>
<td>1033550</td>
<td>1040407</td>
<td>1049328</td>
<td>1058560</td>
<td>1067425</td>
<td>1074304</td>
<td>1075877</td>
<td>1077103</td>
<td>1076280</td>
<td>1071081</td>
<td>1065291</td>
<td>1063488</td>
<td>1062755</td>
<td>1062408</td>
<td>1062320</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Utilitzar province_col = Provincia
Year columnes mostra: ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012']
Parcial desat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\poblacio_long.csv
Estructura de sortida: (1144, 3)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Albacete</td>
<td>2003</td>
<td>370383</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Alacant</td>
<td>2003</td>
<td>1542318</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Almeria</td>
<td>2003</td>
<td>560655</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Araba</td>
<td>2003</td>
<td>290746</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Asturias</td>
<td>2003</td>
<td>1062320</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Avila</td>
<td>2003</td>
<td>163549</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Badajoz</td>
<td>2003</td>
<td>656228</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>Illes Balears</td>
<td>2003</td>
<td>883410</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Barcelona</td>
<td>2003</td>
<td>4956072</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Bizkaia</td>
<td>2003</td>
<td>1125115</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Burgos</td>
<td>2003</td>
<td>352086</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Caceres</td>
<td>2003</td>
<td>404127</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Estructura: (1144, 3)
Years mostra: ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014']
Provincies mostra (primeres 10): ['A Coruna', 'Alacant', 'Albacete', 'Almeria', 'Araba', 'Asturias', 'Avila', 'Badajoz', 'Barcelona', 'Bizkaia']
Valors perduts a 'value': 0</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">province</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1132</th>
<td>Segovia</td>
<td>2024</td>
<td>156620</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1133</th>
<td>Sevilla</td>
<td>2024</td>
<td>1968624</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1134</th>
<td>Soria</td>
<td>2024</td>
<td>90073</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1135</th>
<td>Tarragona</td>
<td>2024</td>
<td>861744</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1136</th>
<td>Teruel</td>
<td>2024</td>
<td>135309</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1137</th>
<td>Toledo</td>
<td>2024</td>
<td>743165</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1138</th>
<td>Valencia</td>
<td>2024</td>
<td>2710808</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1139</th>
<td>Valladolid</td>
<td>2024</td>
<td>525116</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1140</th>
<td>Zamora</td>
<td>2024</td>
<td>166253</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1141</th>
<td>Zaragoza</td>
<td>2024</td>
<td>987763</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1142</th>
<td>Ceuta</td>
<td>2024</td>
<td>83179</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1143</th>
<td>Melilla</td>
<td>2024</td>
<td>85985</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="76b0caba" class="cell" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>Shape input: (4784, 3)
Columns: ['Provincia', 'Any - Trimestre', 'Percentatge']
Detectar columna de percentatge: Percentatge
Mitjanes anuals no ponderades guardades a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\atur_annual_unweighted.csv
   year  annual_mean_pct           method
0  2002        10.894423  unweighted_mean
1  2003        11.128702  unweighted_mean
2  2004        10.943942  unweighted_mean
3  2005         9.610962  unweighted_mean
4  2006         8.921587  unweighted_mean
No s'ha localitzat weight_col. Ometre la mijana ponderada.

Notes:
- Mitjana no ponderada: mitjana aritmètica dels quatre trimestres existents per any.</code></pre>
</div>
</div>
<div id="66ffb603" class="cell" data-execution_count="23">
<div class="cell-output cell-output-stdout">
<pre><code>1) Restaurar 'province' en parcials *_long.csv si cal...
Cap parcial necessita restaurar la provincia.

2) Cercar i processar fitxer RAW d'atur (trimestral)...
Processing atur raw: C:\Users\bfeli\3 BBDD inicials\originals\Excels\atur.xlsx
 - shape: (4784, 3)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Provincia</th>
<th data-quarto-table-cell-role="th">Any - Trimestre</th>
<th data-quarto-table-cell-role="th">Percentatge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Albacete</td>
<td>2024T4</td>
<td>11.37</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Albacete</td>
<td>2024T3</td>
<td>9.92</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Albacete</td>
<td>2024T2</td>
<td>10.74</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Albacete</td>
<td>2024T1</td>
<td>13.23</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Albacete</td>
<td>2023T4</td>
<td>12.09</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Albacete</td>
<td>2023T3</td>
<td>9.11</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> - columnes detectades -&gt; province: Provincia ; time: Any - Trimestre ; percent: Percentatge
Desat per provincia anual atur no ponderat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\atur_annual_by_province_unweighted.csv</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">province_norm</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">atur_annual_mean_pct</th>
<th data-quarto-table-cell-role="th">n_quarters</th>
<th data-quarto-table-cell-role="th">sample_province</th>
<th data-quarto-table-cell-role="th">complete_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>a coruna</td>
<td>2002</td>
<td>12.8525</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>a coruna</td>
<td>2003</td>
<td>13.7550</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>a coruna</td>
<td>2004</td>
<td>14.5075</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>a coruna</td>
<td>2005</td>
<td>9.6325</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>a coruna</td>
<td>2006</td>
<td>8.1225</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>a coruna</td>
<td>2007</td>
<td>8.2225</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>a coruna</td>
<td>2008</td>
<td>8.9175</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>a coruna</td>
<td>2009</td>
<td>11.4700</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>a coruna</td>
<td>2010</td>
<td>13.9800</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>a coruna</td>
<td>2011</td>
<td>15.8275</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>a coruna</td>
<td>2012</td>
<td>18.3800</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>a coruna</td>
<td>2013</td>
<td>20.1800</td>
<td>4</td>
<td>A Coruña</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Resultat desat a partials_individuals/atur_annual_by_province_unweighted.csv
Executar el pipeline de càlcul de rates per100k amb la seguretat que 'province' existeix en els parcials.</code></pre>
</div>
</div>
<div id="6e4af164" class="cell" data-execution_count="24">
<div class="cell-output cell-output-stdout">
<pre><code>Fitxer de població carregat: poblacio_long.csv shape: (1144, 3)
Atur arxiu carregat: atur_annual_by_province_unweighted.csv shape: (1196, 6)

Columnes de població i tipus de dades:
province    object
year         int64
value        int64
dtype: object

Atur columnes i tipus:
province_norm            object
year                      int64
atur_annual_mean_pct    float64
n_quarters                int64
sample_province          object
complete_year              bool
dtype: object
\Mostra de població (primeres files):
   province  year    value
0  Albacete  2003   370383
1   Alacant  2003  1542318
2   Almeria  2003   560655
3     Araba  2003   290746
4  Asturias  2003  1062320

Atur mostra (primeres files):
  province_norm  year  atur_annual_mean_pct  n_quarters sample_province  complete_year
0      a coruna  2002               12.8525           4        A Coruña           True
1      a coruna  2003               13.7550           4        A Coruña           True
2      a coruna  2004               14.5075           4        A Coruña           True
3      a coruna  2005                9.6325           4        A Coruña           True
4      a coruna  2006                8.1225           4        A Coruña           True

pop years int? True, atur years int? True
Columnes year convertides a Int64.

Anys únics a pop_df (mostra): [2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022]
Anys únics a atur_out (mostra): [2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021]

Provincies: pop=52, atur=52, common=52
Mostra de províncies només a població (primeres 20): []
Mostra de provincies només a atur (primeres 20): []

Estructura integrada: (1144, 6)
Mostra del merged:
         province  year  population  province_norm  atur_annual_mean_pct  n_quarters
0        Albacete  2003      370383       albacete                7.7000           4
1         Alacant  2003     1542318        alacant               12.3375           4
2         Almeria  2003      560655        almeria               11.2950           4
3           Araba  2003      290746          araba                9.3450           4
4        Asturias  2003     1062320       asturias               11.3000           4
5           Avila  2003      163549          avila                8.9425           4
6         Badajoz  2003      656228        badajoz               16.3600           4
7   Illes Balears  2003      883410  illes balears                9.7750           4
8       Barcelona  2003     4956072      barcelona               10.8625           4
9         Bizkaia  2003     1125115        bizkaia               11.4450           4
10         Burgos  2003      352086         burgos                8.7100           4
11        Caceres  2003      404127        caceres               18.7675           4

Mostra combinada desada a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\debug_pop_atur_merge_sample.csv</code></pre>
</div>
</div>
<div id="9167bac4" class="cell" data-execution_count="25">
<div class="cell-output cell-output-stdout">
<pre><code>Total de files a rates: 1144
Files de vots perduts desprès de combinació: 0
Files perdudes a 'population': 1144

Resultat desat a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\rates_by_province_year_votes_imputed_share_locf.csv</code></pre>
</div>
</div>
<div id="9be055ef" class="cell" data-execution_count="27">
<div class="cell-output cell-output-stdout">
<pre><code>Using votes file: C:\Users\bfeli\3 BBDD inicials\originals\Excels\Eleccions\merged_votes_edreta.csv
Shape: (364, 4)
Columns: ['year', 'province', 'total_votes', 'votes_edreta']
 year province  total_votes  votes_edreta
 2000  Almeria       278462           487
 2000    Cadiz       553667          1001
 2000  Cordoba       461695           419
 2000  Granada       480242           378
 2000   Huelva       245452           311
 2000     Jaen       399949           397
Columnes detectades -&gt; province: province  year: year  votes: votes_edreta

Saved aggregated votes by province-year to: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\votes_by_province_year_from_merged_explicit.csv
province_norm year  votes province
     a coruna 2000    775 A Coruña
     a coruna 2004    926 A Coruña
     a coruna 2008   1128 A Coruña
     a coruna 2011      0 A Coruña
     a coruna 2016      0 A Coruña
     a coruna 2019  27426 A Coruña
     a coruna 2023  27539 A Coruña
      alacant 2000    485  Alacant
      alacant 2004    709  Alacant
      alacant 2008    626  Alacant
      alacant 2011      0  Alacant
      alacant 2016    617  Alacant

Utilitzar fitxer població: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\poblacio_long.csv
Població estructura: (1144, 3)
Població columnes: ['province', 'year', 'value']
province  year   value
Albacete  2003  370383
 Alacant  2003 1542318
 Almeria  2003  560655
   Araba  2003  290746
Asturias  2003 1062320
   Avila  2003  163549

Population normalized sample:
province_norm year      province  population
     albacete 2003      Albacete      370383
      alacant 2003       Alacant     1542318
      almeria 2003       Almeria      560655
        araba 2003         Araba      290746
     asturias 2003      Asturias     1062320
        avila 2003         Avila      163549
      badajoz 2003       Badajoz      656228
illes balears 2003 Illes Balears      883410
    barcelona 2003     Barcelona     4956072
      bizkaia 2003       Bizkaia     1125115
       burgos 2003        Burgos      352086
      caceres 2003       Caceres      404127

Merged votes amb població: total de files 364; population found for 312; missing population for 52 rows.

Mostra de files amb població faltant (primeres 12):
province_votes province_norm year
      A Coruña      a coruna 2000
       Alacant       alacant 2000
      Albacete      albacete 2000
       Almeria       almeria 2000
         Araba         araba 2000
      Asturias      asturias 2000
         Avila         avila 2000
       Badajoz       badajoz 2000
     Barcelona     barcelona 2000
       Bizkaia       bizkaia 2000
        Burgos        burgos 2000
       Caceres       caceres 2000

Desar final merged votes+population a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\votes_with_population_and_rates.csv

Vista (primees 12 files):
province_norm year  votes province_votes province_pop  population votes_per100k
     a coruna 2000    775       A Coruña          NaN         NaN          None
     a coruna 2004    926       A Coruña     A Coruna   1104699.0     83.823738
     a coruna 2008   1128       A Coruña     A Coruna   1128599.0     99.946925
     a coruna 2011      0       A Coruña     A Coruna   1140069.0           0.0
     a coruna 2016      0       A Coruña     A Coruna   1123015.0           0.0
     a coruna 2019  27426       A Coruña     A Coruna   1120432.0   2447.805846
     a coruna 2023  27539       A Coruña     A Coruna   1123884.0    2450.34185
      alacant 2000    485        Alacant          NaN         NaN          None
      alacant 2004    709        Alacant      Alacant   1602174.0     44.252372
      alacant 2008    626        Alacant      Alacant   1817519.0     34.442556
      alacant 2011      0        Alacant      Alacant   1844439.0           0.0
      alacant 2016    617        Alacant      Alacant   1837873.0     33.571417</code></pre>
</div>
</div>
<div id="3d06b2f3" class="cell" data-scrolled="true" data-execution_count="28">
<div class="cell-output cell-output-stdout">
<pre><code>Columnes en population_imputed_linear.csv: ['province_norm', 'year', 'population', 'imputed_population_method', 'population_source_year']
Crear 'province' des de 'province_norm' (majúscules, accents es poden perdre).
S'ha desat la població corregida a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\population_imputed_linear_with_province.csv
Mostra de files:
province_norm year  population province
     a coruna 2003   1100954.0 A Coruna
     a coruna 2004   1104699.0 A Coruna
     a coruna 2005   1109955.0 A Coruna
     a coruna 2006   1115415.0 A Coruna
     a coruna 2007   1121347.0 A Coruna
     a coruna 2008   1128599.0 A Coruna
     a coruna 2009   1135287.0 A Coruna
     a coruna 2010   1138107.0 A Coruna
     a coruna 2011   1140069.0 A Coruna
     a coruna 2012   1141178.0 A Coruna</code></pre>
</div>
</div>
<div id="3264bfa2" class="cell" data-execution_count="29">
<div class="cell-output cell-output-stdout">
<pre><code>Desar arxiu unificar a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\rates_all_metrics_by_province_year_unified_fixed.csv
Files: 1196
Columnes: ['province_norm', 'year', 'province', 'population', 'population_imputed_from_nearest', 'denuncies', 'denuncies_per100k', 'ordres', 'ordres_per100k', 'feminicidis', 'feminicidis_per100k', 'immigracio', 'immigracio_per100k', 'votes', 'votes_per100k', 'atur_annual_mean_pct', 'n_quarters', 'atur_used_pct', 'unemployed_est', 'unemployed_per100k']

Vista:
province_norm year province  population  population_imputed_from_nearest  denuncies  denuncies_per100k  ordres  ordres_per100k  feminicidis  feminicidis_per100k  immigracio  immigracio_per100k  votes  votes_per100k  atur_annual_mean_pct  n_quarters  atur_used_pct  unemployed_est  unemployed_per100k
     a coruna 2000      NaN   1100954.0                             True        NaN                NaN     NaN             NaN          NaN                  NaN         NaN                 NaN  775.0      70.393495                   NaN         NaN            NaN             NaN                 NaN
     a coruna 2003 A Coruna   1100954.0                            False    12540.0        1139.012166     0.0        0.000000          3.0             0.272491     18212.0         1654.201720    0.0       0.000000               13.7550         4.0        13.7550   151436.222700             13755.0
     a coruna 2004 A Coruna   1104699.0                            False    13880.0        1256.450852  5420.0      490.631385          1.0             0.090522     19945.0         1805.469182  926.0      83.823738               14.5075         4.0        14.5075   160264.207425             14507.5
     a coruna 2005 A Coruna   1109955.0                            False    10550.0         950.488984  4060.0      365.780595          0.0             0.000000     23855.0         2149.186228    0.0       0.000000                9.6325         4.0         9.6325   106916.415375              9632.5
     a coruna 2006 A Coruna   1115415.0                            False    22010.0        1973.256591  6530.0      585.432328          0.0             0.000000     25468.0         2283.275731    0.0       0.000000                8.1225         4.0         8.1225    90599.583375              8122.5
     a coruna 2007 A Coruna   1121347.0                            False    19830.0        1768.408887  5010.0      446.784091          2.0             0.178357     28137.0         2509.214365    0.0       0.000000                8.2225         4.0         8.2225    92202.757075              8222.5
     a coruna 2008 A Coruna   1128599.0                            False    24020.0        2128.302435  4340.0      384.547567          2.0             0.177211      6645.0          588.783084 1128.0      99.946925                8.9175         4.0         8.9175   100642.815825              8917.5
     a coruna 2009 A Coruna   1135287.0                            False    24000.0        2114.002891  4050.0      356.737988          2.0             0.176167      4131.0          363.872748    0.0       0.000000               11.4700         4.0        11.4700   130217.418900             11470.0</code></pre>
</div>
</div>
<div id="4166c9fa" class="cell" data-execution_count="30">
<div class="cell-output cell-output-stdout">
<pre><code>Carpeta: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals existeix: True
Trobar fitxers relacionats amb vots (nom | mida bytes | vista de les primeres files):

---- FE_denuncies_per100k_votes_params.csv | mida: 200
        Unnamed: 0      coef       se
votes_per100k_used -0.001462 0.001168
immigracio_per100k -0.012460 0.013322
unemployed_per100k -0.003025 0.012645

---- FE_feminicidis_per100k_votes_params.csv | mida: 206
        Unnamed: 0          coef           se
votes_per100k_used  7.758543e-07 1.620309e-07
immigracio_per100k  3.340548e-06 3.166263e-06
unemployed_per100k -2.874713e-06 3.209538e-06

---- FE_ordres_per100k_votes_params.csv | mida: 198
        Unnamed: 0     coef       se
votes_per100k_used 0.000581 0.000436
immigracio_per100k 0.012191 0.006124
unemployed_per100k 0.015046 0.004214

---- forest_combined_votes_per100k_grouped.png | mida: 73109
  (No s'ha pogut visualitzar el fitxer) File is not a zip file

---- forest_combined_votes_per100k_table.csv | mida: 1770
    spec          coef           se      ci95_low  ci95_high      z        p  per1000_change_per100k  change_500k_cases    N  N_provinces     years                notes  model  outcome          label
  FE_log -3.647923e+01 8.198371e+01 -1.966000e+02 123.642000 -0.445 0.657000                     NaN                NaN 1145           53 2003-2024                  NaN    NaN      NaN    |  | FE_log
  FE_log  5.855910e+01 2.749678e+01  4.231000e+00 112.887000  2.129 0.033000                     NaN                NaN 1145           53 2003-2024                  NaN    NaN      NaN    |  | FE_log
  FE_log -2.943296e-03 1.102395e-02 -2.370000e-02   0.017800 -0.267 0.789000                     NaN                NaN 1145           53 2003-2024                  NaN    NaN      NaN    |  | FE_log
FE_votes -1.461509e-03 1.167770e-03 -3.750338e-03   0.000827 -1.252 0.210000               -1.461509          -7.307545 1145           53 2003-2024                  NaN    NaN      NaN  |  | FE_votes
FE_votes  5.810832e-04 4.361602e-04 -2.737908e-04   0.001436  1.333 0.183000                0.581083           2.905415 1145           53 2003-2024                  NaN    NaN      NaN  |  | FE_votes
FE_votes  7.758543e-07 1.620309e-07  4.582738e-07   0.000001  4.789 0.000002                0.000776           0.003879 1145           53 2003-2024 FE (per100k outcome)    NaN      NaN  |  | FE_votes

---- heatmap_missing_votes_per100k.png | mida: 235593
  (No s'ha pogut visualitzar el fitxer) File is not a zip file

---- preview_top3_rates_all_metrics_by_province_year_unified_fixed_voteslocf_csv.csv | mida: 36153
province_norm  year province  population  population_imputed_from_nearest  denuncies  denuncies_per100k  ordres  ordres_per100k  feminicidis  feminicidis_per100k  immigracio  immigracio_per100k  votes  votes_per100k  atur_annual_mean_pct  n_quarters  atur_used_pct  unemployed_est  unemployed_per100k
     a coruna  2000      NaN   1100954.0                             True        NaN                NaN     NaN             NaN          NaN                  NaN         NaN                 NaN  775.0      70.393495                   NaN         NaN            NaN             NaN                 NaN
     a coruna  2003 A Coruna   1100954.0                            False    12540.0        1139.012166     0.0        0.000000          3.0             0.272491     18212.0         1654.201720    0.0       0.000000               13.7550         4.0        13.7550   151436.222700             13755.0
     a coruna  2004 A Coruna   1104699.0                            False    13880.0        1256.450852  5420.0      490.631385          1.0             0.090522     19945.0         1805.469182  926.0      83.823738               14.5075         4.0        14.5075   160264.207425             14507.5
     a coruna  2005 A Coruna   1109955.0                            False    10550.0         950.488984  4060.0      365.780595          0.0             0.000000     23855.0         2149.186228    0.0       0.000000                9.6325         4.0         9.6325   106916.415375              9632.5
     a coruna  2006 A Coruna   1115415.0                            False    22010.0        1973.256591  6530.0      585.432328          0.0             0.000000     25468.0         2283.275731    0.0       0.000000                8.1225         4.0         8.1225    90599.583375              8122.5
     a coruna  2007 A Coruna   1121347.0                            False    19830.0        1768.408887  5010.0      446.784091          2.0             0.178357     28137.0         2509.214365    0.0       0.000000                8.2225         4.0         8.2225    92202.757075              8222.5

---- processed_heatmap_missing_votes_per100k.png | mida: 235493
  (No s'ha pogut visualitzar el fitxer) File is not a zip file

---- processed_missing_by_prov_votes_per100k.csv | mida: 724
  province  votes_per100k
  A Coruna            0.0
   Alacant            0.0
Las Palmas            0.0
      Leon            0.0
    Lleida            0.0
      Lugo            0.0

---- processed_missing_by_year_votes_per100k.csv | mida: 250
 year  votes_per100k
 2000            0.0
 2003            0.0
 2004            0.0
 2005            0.0
 2006            0.0
 2007            0.0

---- rates_all_metrics_by_province_year_unified_fixed_voteslocf.csv | mida: 213812
province_norm  year province  population  population_imputed_from_nearest  denuncies  denuncies_per100k  ordres  ordres_per100k  feminicidis  feminicidis_per100k  immigracio  immigracio_per100k  votes  votes_per100k  atur_annual_mean_pct  n_quarters  atur_used_pct  unemployed_est  unemployed_per100k
     a coruna  2000      NaN   1100954.0                             True        NaN                NaN     NaN             NaN          NaN                  NaN         NaN                 NaN  775.0      70.393495                   NaN         NaN            NaN             NaN                 NaN
     a coruna  2003 A Coruna   1100954.0                            False    12540.0        1139.012166     0.0        0.000000          3.0             0.272491     18212.0         1654.201720    0.0       0.000000               13.7550         4.0        13.7550   151436.222700             13755.0
     a coruna  2004 A Coruna   1104699.0                            False    13880.0        1256.450852  5420.0      490.631385          1.0             0.090522     19945.0         1805.469182  926.0      83.823738               14.5075         4.0        14.5075   160264.207425             14507.5
     a coruna  2005 A Coruna   1109955.0                            False    10550.0         950.488984  4060.0      365.780595          0.0             0.000000     23855.0         2149.186228    0.0       0.000000                9.6325         4.0         9.6325   106916.415375              9632.5
     a coruna  2006 A Coruna   1115415.0                            False    22010.0        1973.256591  6530.0      585.432328          0.0             0.000000     25468.0         2283.275731    0.0       0.000000                8.1225         4.0         8.1225    90599.583375              8122.5
     a coruna  2007 A Coruna   1121347.0                            False    19830.0        1768.408887  5010.0      446.784091          2.0             0.178357     28137.0         2509.214365    0.0       0.000000                8.2225         4.0         8.2225    92202.757075              8222.5

---- rates_all_metrics_by_province_year_unified_fixed_voteslocf_final.csv | mida: 255081
province_norm  year province  population  population_imputed_from_nearest  denuncies  denuncies_per100k  ordres  ordres_per100k  feminicidis  feminicidis_per100k  immigracio  immigracio_per100k  votes  votes_per100k  atur_annual_mean_pct  n_quarters  atur_used_pct  unemployed_est  unemployed_per100k  votes_final votes_imputed_method  votes_combined  votes_source_observed_count votes_imputed_flag
     a coruna  2000      NaN   1100954.0                             True        NaN                NaN     NaN             NaN          NaN                  NaN         NaN                 NaN  775.0      70.393495                   NaN         NaN            NaN             NaN                 NaN        775.0             observed           775.0                            1           observed
     a coruna  2003 A Coruna   1100954.0                            False    12540.0        1139.012166     0.0        0.000000          3.0             0.272491     18212.0         1654.201720    0.0       0.000000               13.7550         4.0        13.7550   151436.222700             13755.0        775.0           locf_bfill             0.0                            1         locf_bfill
     a coruna  2004 A Coruna   1104699.0                            False    13880.0        1256.450852  5420.0      490.631385          1.0             0.090522     19945.0         1805.469182  926.0      83.823738               14.5075         4.0        14.5075   160264.207425             14507.5        926.0             observed           926.0                            1           observed
     a coruna  2005 A Coruna   1109955.0                            False    10550.0         950.488984  4060.0      365.780595          0.0             0.000000     23855.0         2149.186228    0.0       0.000000                9.6325         4.0         9.6325   106916.415375              9632.5        926.0           locf_bfill             0.0                            1         locf_bfill
     a coruna  2006 A Coruna   1115415.0                            False    22010.0        1973.256591  6530.0      585.432328          0.0             0.000000     25468.0         2283.275731    0.0       0.000000                8.1225         4.0         8.1225    90599.583375              8122.5        926.0           locf_bfill             0.0                            1         locf_bfill
     a coruna  2007 A Coruna   1121347.0                            False    19830.0        1768.408887  5010.0      446.784091          2.0             0.178357     28137.0         2509.214365    0.0       0.000000                8.2225         4.0         8.2225    92202.757075              8222.5        926.0           locf_bfill             0.0                            1         locf_bfill

---- rates_all_metrics_by_province_year_unified_fixed_voteslocf_final_fixedzeros.csv | mida: 305027
province_norm  year province  population  population_imputed_from_nearest  denuncies  denuncies_per100k  ordres  ordres_per100k  feminicidis  feminicidis_per100k  immigracio  immigracio_per100k  votes  votes_per100k  atur_annual_mean_pct  n_quarters  atur_used_pct  unemployed_est  unemployed_per100k  votes_final votes_imputed_method  votes_combined  votes_source_observed_count votes_imputed_flag  votes_original  votes_used votes_used_flag  votes_per100k_used
     a coruna  2000      NaN   1100954.0                             True        NaN                NaN     NaN             NaN          NaN                  NaN         NaN                 NaN  775.0      70.393495                   NaN         NaN            NaN             NaN                 NaN        775.0             observed           775.0                            1           observed           775.0       775.0        original           70.393495
     a coruna  2003 A Coruna   1100954.0                            False    12540.0        1139.012166     0.0        0.000000          3.0             0.272491     18212.0         1654.201720    0.0       0.000000               13.7550         4.0        13.7550   151436.222700             13755.0        775.0           locf_bfill             0.0                            1         locf_bfill             0.0       775.0    imputed_used           70.393495
     a coruna  2004 A Coruna   1104699.0                            False    13880.0        1256.450852  5420.0      490.631385          1.0             0.090522     19945.0         1805.469182  926.0      83.823738               14.5075         4.0        14.5075   160264.207425             14507.5        926.0             observed           926.0                            1           observed           926.0       926.0        original           83.823738
     a coruna  2005 A Coruna   1109955.0                            False    10550.0         950.488984  4060.0      365.780595          0.0             0.000000     23855.0         2149.186228    0.0       0.000000                9.6325         4.0         9.6325   106916.415375              9632.5        926.0           locf_bfill             0.0                            1         locf_bfill             0.0       926.0    imputed_used           83.426806
     a coruna  2006 A Coruna   1115415.0                            False    22010.0        1973.256591  6530.0      585.432328          0.0             0.000000     25468.0         2283.275731    0.0       0.000000                8.1225         4.0         8.1225    90599.583375              8122.5        926.0           locf_bfill             0.0                            1         locf_bfill             0.0       926.0    imputed_used           83.018428
     a coruna  2007 A Coruna   1121347.0                            False    19830.0        1768.408887  5010.0      446.784091          2.0             0.178357     28137.0         2509.214365    0.0       0.000000                8.2225         4.0         8.2225    92202.757075              8222.5        926.0           locf_bfill             0.0                            1         locf_bfill             0.0       926.0    imputed_used           82.579255

---- rates_all_metrics_by_province_year_unified_fixed_voteslocf_zerosNA.csv | mida: 227573
province_norm  year province  population  population_imputed_from_nearest  denuncies  denuncies_per100k  ordres  ordres_per100k  feminicidis  feminicidis_per100k  immigracio  immigracio_per100k  votes  votes_per100k  atur_annual_mean_pct  n_quarters  atur_used_pct  unemployed_est  unemployed_per100k  votes_final  votes_combined
     a coruna  2000      NaN   1100954.0                             True        NaN                NaN     NaN             NaN          NaN                  NaN         NaN                 NaN  775.0      70.393495                   NaN         NaN            NaN             NaN                 NaN        775.0           775.0
     a coruna  2003 A Coruna   1100954.0                            False    12540.0        1139.012166     0.0        0.000000          3.0             0.272491     18212.0         1654.201720    0.0       0.000000               13.7550         4.0        13.7550   151436.222700             13755.0        775.0             0.0
     a coruna  2004 A Coruna   1104699.0                            False    13880.0        1256.450852  5420.0      490.631385          1.0             0.090522     19945.0         1805.469182  926.0      83.823738               14.5075         4.0        14.5075   160264.207425             14507.5        926.0           926.0
     a coruna  2005 A Coruna   1109955.0                            False    10550.0         950.488984  4060.0      365.780595          0.0             0.000000     23855.0         2149.186228    0.0       0.000000                9.6325         4.0         9.6325   106916.415375              9632.5        926.0             0.0
     a coruna  2006 A Coruna   1115415.0                            False    22010.0        1973.256591  6530.0      585.432328          0.0             0.000000     25468.0         2283.275731    0.0       0.000000                8.1225         4.0         8.1225    90599.583375              8122.5        926.0             0.0
     a coruna  2007 A Coruna   1121347.0                            False    19830.0        1768.408887  5010.0      446.784091          2.0             0.178357     28137.0         2509.214365    0.0       0.000000                8.2225         4.0         8.2225    92202.757075              8222.5        926.0             0.0

---- rates_by_province_year_votes_imputed_share_locf.csv | mida: 79163
province province_norm  year  population  denuncies  denuncies_per100k  ordres  ordres_per100k  feminicidis  feminicidis_per100k  immigracio  immigracio_per100k  votes  votes_per100k  atur_annual_mean_pct  atur_annual_weighted_pct  n_quarters  atur_used_pct  unemployed_est  unemployed_per100k
Albacete      albacete  2003         NaN        0.0                NaN     0.0             NaN          0.0                  NaN         0.0                 NaN    0.0            NaN                7.7000                       NaN           4         7.7000             NaN                 NaN
 Alacant       alacant  2003         NaN        0.0                NaN     0.0             NaN          0.0                  NaN         0.0                 NaN    0.0            NaN               12.3375                       NaN           4        12.3375             NaN                 NaN
 Almeria       almeria  2003         NaN        0.0                NaN     0.0             NaN          0.0                  NaN         0.0                 NaN    0.0            NaN               11.2950                       NaN           4        11.2950             NaN                 NaN
   Araba         araba  2003         NaN        0.0                NaN     0.0             NaN          0.0                  NaN         0.0                 NaN    0.0            NaN                9.3450                       NaN           4         9.3450             NaN                 NaN
Asturias      asturias  2003         NaN        0.0                NaN     0.0             NaN          0.0                  NaN         0.0                 NaN    0.0            NaN               11.3000                       NaN           4        11.3000             NaN                 NaN
   Avila         avila  2003         NaN        0.0                NaN     0.0             NaN          0.0                  NaN         0.0                 NaN    0.0            NaN                8.9425                       NaN           4         8.9425             NaN                 NaN

---- votes_by_province_year_from_merged_explicit.csv | mida: 10002
province_norm  year  votes province
     a coruna  2000    775 A Coruña
     a coruna  2004    926 A Coruña
     a coruna  2008   1128 A Coruña
     a coruna  2011      0 A Coruña
     a coruna  2016      0 A Coruña
     a coruna  2019  27426 A Coruña

---- votes_by_province_year_from_merged_explicit.csv | mida: 10002
province_norm  year  votes province
     a coruna  2000    775 A Coruña
     a coruna  2004    926 A Coruña
     a coruna  2008   1128 A Coruña
     a coruna  2011      0 A Coruña
     a coruna  2016      0 A Coruña
     a coruna  2019  27426 A Coruña

---- votes_imputed_interpolate.csv | mida: 75496
province_norm  year province  population  votes_imputed imputation_method  votes_per100k
     a coruna  2000 A Coruña         NaN         775.00          observed            NaN
     a coruna  2003      NaN   1100954.0         888.25      interpolated      80.680028
     a coruna  2004 A Coruña   1104699.0         926.00          observed      83.823738
     a coruna  2005      NaN   1109955.0         976.50      interpolated      87.976540
     a coruna  2006      NaN   1115415.0        1027.00      interpolated      92.073354
     a coruna  2007      NaN   1121347.0        1077.50      interpolated      96.089792

---- votes_imputed_interpolate.csv | mida: 75496
province_norm  year province  population  votes_imputed imputation_method  votes_per100k
     a coruna  2000 A Coruña         NaN         775.00          observed            NaN
     a coruna  2003      NaN   1100954.0         888.25      interpolated      80.680028
     a coruna  2004 A Coruña   1104699.0         926.00          observed      83.823738
     a coruna  2005      NaN   1109955.0         976.50      interpolated      87.976540
     a coruna  2006      NaN   1115415.0        1027.00      interpolated      92.073354
     a coruna  2007      NaN   1121347.0        1077.50      interpolated      96.089792

---- votes_imputed_share_interpolate_refined.csv | mida: 42403
province_norm  year  votes  votes_imputed imputation_method  denominator
     a coruna  2000  775.0          775.0          observed     533458.0
     a coruna  2003    NaN            NaN      share_interp          NaN
     a coruna  2004  926.0          926.0          observed     607616.0
     a coruna  2005    NaN            NaN      share_interp          NaN
     a coruna  2006    NaN            NaN      share_interp          NaN
     a coruna  2007    NaN            NaN      share_interp          NaN

---- votes_imputed_share_interpolate_refined.csv | mida: 42403
province_norm  year  votes  votes_imputed imputation_method  denominator
     a coruna  2000  775.0          775.0          observed     533458.0
     a coruna  2003    NaN            NaN      share_interp          NaN
     a coruna  2004  926.0          926.0          observed     607616.0
     a coruna  2005    NaN            NaN      share_interp          NaN
     a coruna  2006    NaN            NaN      share_interp          NaN
     a coruna  2007    NaN            NaN      share_interp          NaN

---- votes_imputed_share_locf.csv | mida: 40739
province_norm  year  votes  votes_imputed imputation_method  denominator
     a coruna  2000  775.0          775.0          observed     533458.0
     a coruna  2003    NaN            NaN        share_locf          NaN
     a coruna  2004  926.0          926.0          observed     607616.0
     a coruna  2005    NaN            NaN        share_locf          NaN
     a coruna  2006    NaN            NaN        share_locf          NaN
     a coruna  2007    NaN            NaN        share_locf          NaN

---- votes_imputed_share_locf.csv | mida: 40739
province_norm  year  votes  votes_imputed imputation_method  denominator
     a coruna  2000  775.0          775.0          observed     533458.0
     a coruna  2003    NaN            NaN        share_locf          NaN
     a coruna  2004  926.0          926.0          observed     607616.0
     a coruna  2005    NaN            NaN        share_locf          NaN
     a coruna  2006    NaN            NaN        share_locf          NaN
     a coruna  2007    NaN            NaN        share_locf          NaN

---- votes_imputed_share_locf_refined.csv | mida: 40739
province_norm  year  votes  votes_imputed imputation_method  denominator
     a coruna  2000  775.0          775.0          observed     533458.0
     a coruna  2003    NaN            NaN        share_locf          NaN
     a coruna  2004  926.0          926.0          observed     607616.0
     a coruna  2005    NaN            NaN        share_locf          NaN
     a coruna  2006    NaN            NaN        share_locf          NaN
     a coruna  2007    NaN            NaN        share_locf          NaN

---- votes_imputed_share_locf_refined.csv | mida: 40739
province_norm  year  votes  votes_imputed imputation_method  denominator
     a coruna  2000  775.0          775.0          observed     533458.0
     a coruna  2003    NaN            NaN        share_locf          NaN
     a coruna  2004  926.0          926.0          observed     607616.0
     a coruna  2005    NaN            NaN        share_locf          NaN
     a coruna  2006    NaN            NaN        share_locf          NaN
     a coruna  2007    NaN            NaN        share_locf          NaN

---- votes_per100k_correlation_pearson_refined.csv | mida: 262
              Unnamed: 0  votes_per100k_locf_lin  votes_per100k_interp_lin  votes_per100k_locf_nat  votes_per100k_interp_nat
  votes_per100k_locf_lin                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_lin                     1.0                       1.0                     1.0                       1.0
  votes_per100k_locf_nat                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_nat                     1.0                       1.0                     1.0                       1.0

---- votes_per100k_correlation_pearson_refined.csv | mida: 262
              Unnamed: 0  votes_per100k_locf_lin  votes_per100k_interp_lin  votes_per100k_locf_nat  votes_per100k_interp_nat
  votes_per100k_locf_lin                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_lin                     1.0                       1.0                     1.0                       1.0
  votes_per100k_locf_nat                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_nat                     1.0                       1.0                     1.0                       1.0

---- votes_per100k_correlation_spearman_refined.csv | mida: 262
              Unnamed: 0  votes_per100k_locf_lin  votes_per100k_interp_lin  votes_per100k_locf_nat  votes_per100k_interp_nat
  votes_per100k_locf_lin                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_lin                     1.0                       1.0                     1.0                       1.0
  votes_per100k_locf_nat                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_nat                     1.0                       1.0                     1.0                       1.0

---- votes_per100k_correlation_spearman_refined.csv | mida: 262
              Unnamed: 0  votes_per100k_locf_lin  votes_per100k_interp_lin  votes_per100k_locf_nat  votes_per100k_interp_nat
  votes_per100k_locf_lin                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_lin                     1.0                       1.0                     1.0                       1.0
  votes_per100k_locf_nat                     1.0                       1.0                     1.0                       1.0
votes_per100k_interp_nat                     1.0                       1.0                     1.0                       1.0

---- votes_per100k_variants_comparison.csv | mida: 40972
province_norm  year  votes_per100k_locf_lin  votes_per100k_interp_lin  votes_per100k_locf_nat  votes_per100k_interp_nat
     a coruna  2000                     NaN                       NaN                     NaN                       NaN
     a coruna  2003                     NaN                       NaN                     NaN                       NaN
     a coruna  2004               83.823738                 83.823738               83.823738                 83.823738
     a coruna  2005                     NaN                       NaN                     NaN                       NaN
     a coruna  2006                     NaN                       NaN                     NaN                       NaN
     a coruna  2007                     NaN                       NaN                     NaN                       NaN

---- votes_per100k_variants_comparison.csv | mida: 40972
province_norm  year  votes_per100k_locf_lin  votes_per100k_interp_lin  votes_per100k_locf_nat  votes_per100k_interp_nat
     a coruna  2000                     NaN                       NaN                     NaN                       NaN
     a coruna  2003                     NaN                       NaN                     NaN                       NaN
     a coruna  2004               83.823738                 83.823738               83.823738                 83.823738
     a coruna  2005                     NaN                       NaN                     NaN                       NaN
     a coruna  2006                     NaN                       NaN                     NaN                       NaN
     a coruna  2007                     NaN                       NaN                     NaN                       NaN

---- votes_with_population_and_rates.csv | mida: 20720
province_norm  year  votes province_votes province_pop  population  votes_per100k
     a coruna  2000    775       A Coruña          NaN         NaN            NaN
     a coruna  2004    926       A Coruña     A Coruna   1104699.0      83.823738
     a coruna  2008   1128       A Coruña     A Coruna   1128599.0      99.946925
     a coruna  2011      0       A Coruña     A Coruna   1140069.0       0.000000
     a coruna  2016      0       A Coruña     A Coruna   1123015.0       0.000000
     a coruna  2019  27426       A Coruña     A Coruna   1120432.0    2447.805846

---- votes_with_population_and_rates.csv | mida: 20720
province_norm  year  votes province_votes province_pop  population  votes_per100k
     a coruna  2000    775       A Coruña          NaN         NaN            NaN
     a coruna  2004    926       A Coruña     A Coruna   1104699.0      83.823738
     a coruna  2008   1128       A Coruña     A Coruna   1128599.0      99.946925
     a coruna  2011      0       A Coruña     A Coruna   1140069.0       0.000000
     a coruna  2016      0       A Coruña     A Coruna   1123015.0       0.000000
     a coruna  2019  27426       A Coruña     A Coruna   1120432.0    2447.805846
</code></pre>
</div>
</div>
<div id="2209d3b7" class="cell" data-execution_count="31">
<div class="cell-output cell-output-stdout">
<pre><code>S'ha desat un final unificat amb LOCF/BCKF imputació i auditant les senyals a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\rates_all_metrics_by_province_year_unified_fixed_voteslocf_final.csv

Exemples (province_norm, year, votes, votes_per100k, votes_imputed_flag):
province_norm year   votes  votes_per100k votes_imputed_flag
     a coruna 2000   775.0      70.393495           observed
     a coruna 2003     0.0       0.000000         locf_bfill
     a coruna 2004   926.0      83.823738           observed
     a coruna 2005     0.0       0.000000         locf_bfill
     a coruna 2006     0.0       0.000000         locf_bfill
     a coruna 2007     0.0       0.000000         locf_bfill
     a coruna 2008  1128.0      99.946925           observed
     a coruna 2009     0.0       0.000000         locf_bfill
     a coruna 2010     0.0       0.000000         locf_bfill
     a coruna 2011     0.0       0.000000         locf_bfill
     a coruna 2012     0.0       0.000000         locf_bfill
     a coruna 2013     0.0       0.000000         locf_bfill
     a coruna 2014     0.0       0.000000         locf_bfill
     a coruna 2015     0.0       0.000000         locf_bfill
     a coruna 2016     0.0       0.000000         locf_bfill
     a coruna 2017     0.0       0.000000         locf_bfill
     a coruna 2018     0.0       0.000000         locf_bfill
     a coruna 2019 27426.0    2447.805846           observed
     a coruna 2020     0.0       0.000000         locf_bfill
     a coruna 2021     0.0       0.000000         locf_bfill

Comptadors del mètode d'imputació:
votes_imputed_flag
locf_bfill    881
observed      313
missing         2</code></pre>
</div>
</div>
<div id="bd3856fc" class="cell" data-execution_count="32">
<div class="cell-output cell-output-stdout">
<pre><code>Saved corrected file to: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\rates_all_metrics_by_province_year_unified_fixed_voteslocf_final_fixedzeros.csv

Counts of votes_used_flag:
votes_used_flag
imputed_used    883
original        313

Sample (province_norm, year, votes_original, votes_final, votes_used, votes_per100k_used, votes_used_flag):
province_norm  year  votes_original  votes_final  votes_used  votes_per100k_used votes_used_flag
     a coruna  2000           775.0        775.0       775.0           70.393495        original
     a coruna  2003             0.0        775.0       775.0           70.393495    imputed_used
     a coruna  2004           926.0        926.0       926.0           83.823738        original
     a coruna  2005             0.0        926.0       926.0           83.426806    imputed_used
     a coruna  2006             0.0        926.0       926.0           83.018428    imputed_used
     a coruna  2007             0.0        926.0       926.0           82.579255    imputed_used
     a coruna  2008          1128.0       1128.0      1128.0           99.946925        original
     a coruna  2009             0.0       1128.0      1128.0           99.358136    imputed_used
     a coruna  2010             0.0       1128.0      1128.0           99.111946    imputed_used
     a coruna  2011             0.0       1128.0      1128.0           98.941380    imputed_used
     a coruna  2012             0.0       1128.0      1128.0           98.845228    imputed_used
     a coruna  2013             0.0       1128.0      1128.0           99.130847    imputed_used
     a coruna  2014             0.0       1128.0      1128.0           99.594207    imputed_used
     a coruna  2015             0.0       1128.0      1128.0          100.035828    imputed_used
     a coruna  2016             0.0       1128.0      1128.0          100.443894    imputed_used
     a coruna  2017             0.0       1128.0      1128.0          100.687136    imputed_used
     a coruna  2018             0.0       1128.0      1128.0          100.707632    imputed_used
     a coruna  2019         27426.0      27426.0     27426.0         2447.805846        original
     a coruna  2020             0.0      27426.0     27426.0         2444.398098    imputed_used
     a coruna  2021             0.0      27426.0     27426.0         2447.655111    imputed_used
     a coruna  2022             0.0      27426.0     27426.0         2450.579182    imputed_used
     a coruna  2023         27539.0      27539.0     27539.0         2450.341850        original
     a coruna  2024             0.0      27539.0     27539.0         2440.429297    imputed_used
      alacant  2000           485.0        485.0       485.0           31.446174        original
      alacant  2003             0.0        485.0       485.0           31.446174    imputed_used
      alacant  2004           709.0        709.0       709.0           44.252372        original
      alacant  2005             0.0        709.0       709.0           42.668175    imputed_used
      alacant  2006             0.0        709.0       709.0           41.366820    imputed_used
      alacant  2007             0.0        709.0       709.0           40.139952    imputed_used
      alacant  2008           626.0        626.0       626.0           34.442556        original

Top 10 by votes_per100k_used:
province_norm  year  votes_used  votes_per100k_used
         lugo  2022    524176.0       161662.965704
         lugo  2021    524176.0       160756.651987
         lugo  2020    524176.0       160018.072308
         lugo  2019    524176.0       159290.120643
         lugo  2023    507915.0       156634.810203
         lugo  2024    507915.0       156258.460289
     la rioja  2023    219388.0        68073.302263
     la rioja  2024    219388.0        67673.913580
     la rioja  2019    170070.0        53825.241244
     la rioja  2020    170070.0        53363.162568</code></pre>
</div>
</div>
<div id="7bb4657c" class="cell" data-execution_count="33">
<div class="cell-output cell-output-stdout">
<pre><code>Loaded unified (rows): 1196

Top 30 files de votes_per100k_used:
province_norm  province  year  votes_used  votes_per100k_used votes_used_flag
         lugo      Lugo  2022    524176.0       161662.965704    imputed_used
         lugo      Lugo  2021    524176.0       160756.651987    imputed_used
         lugo      Lugo  2020    524176.0       160018.072308    imputed_used
         lugo      Lugo  2019    524176.0       159290.120643        original
         lugo      Lugo  2023    507915.0       156634.810203        original
         lugo      Lugo  2024    507915.0       156258.460289    imputed_used
     la rioja  La Rioja  2023    219388.0        68073.302263        original
     la rioja  La Rioja  2024    219388.0        67673.913580    imputed_used
     la rioja  La Rioja  2019    170070.0        53825.241244        original
     la rioja  La Rioja  2020    170070.0        53363.162568    imputed_used
     la rioja  La Rioja  2021    170070.0        53239.378420    imputed_used
     la rioja  La Rioja  2022    170070.0        53210.561391    imputed_used
        soria     Soria  2023     25858.0        28882.584219        original
        soria     Soria  2024     25858.0        28707.825875    imputed_used
        soria     Soria  2022     24382.0        27603.305785    imputed_used
        soria     Soria  2021     24382.0        27458.444074    imputed_used
        soria     Soria  2019     24382.0        27393.043322        original
        soria     Soria  2020     24382.0        27302.859958    imputed_used
      navarra   Navarra  2023    163500.0        24324.746524        original
      navarra   Navarra  2024    163500.0        24103.205948    imputed_used
    salamanca Salamanca  2023     76325.0        23334.627578        original
    salamanca Salamanca  2024     76325.0        23301.643708    imputed_used
        avila     Avila  2023     36750.0        23002.678951        original
        avila     Avila  2024     36750.0        22902.475960    imputed_used
      navarra   Navarra  2019    143234.0        21941.583678        original
      navarra   Navarra  2020    143234.0        21705.179669    imputed_used
      navarra   Navarra  2021    143234.0        21635.510066    imputed_used
      navarra   Navarra  2022    143234.0        21554.700127    imputed_used
        avila     Avila  2020     33948.0        21375.276258    imputed_used
        avila     Avila  2021     33948.0        21364.649020    imputed_used

Summary votes_per100k_used:
count      1196.000000
mean       3072.559991
std       12539.287762
min           5.196116
50%         147.295285
90%        7225.468284
95%       10203.413603
99%       30098.983078
max      161662.965704

99th llindar de percentils: 30098.983078021076
Provincies per sobre 99th percentils: ['la rioja', 'lugo']

Vots observats (anchors) per province_norm='la rioja':
province_norm  year  votes province
     la rioja  2000   1857 La Rioja
     la rioja  2004   5904 La Rioja
     la rioja  2008   4464 La Rioja
     la rioja  2011   5579 La Rioja
     la rioja  2016   4846 La Rioja
     la rioja  2019 170070 La Rioja
     la rioja  2023 219388 La Rioja

Vots observats (anchors) per province_norm='lugo':
province_norm  year  votes province
         lugo  2000   4197     Lugo
         lugo  2004  13903     Lugo
         lugo  2008  11915     Lugo
         lugo  2011      0     Lugo
         lugo  2016  20749     Lugo
         lugo  2019 524176     Lugo
         lugo  2023 507915     Lugo

No s'ha trobat el fitxer de vots Locf a: C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\votes_imputed_locf.csv

Desar votes_extreme_rows.csv with 12 rows to C:\Users\bfeli\3 BBDD inicials\originals\Excels\partials_individuals\analysis_results</code></pre>
</div>
</div>
<div id="4a2eb07a" class="cell" data-execution_count="35">
<div class="cell-output cell-output-stdout">
<pre><code>
=== BASE sample dtypes and head ===
province_norm    object
year              Int64
dtype: object
  province_norm  year
0      albacete  2003
1       alacant  2003
2       almeria  2003
3         araba  2003
4      asturias  2003

=== RATES sample dtypes and head ===
province_norm    object
year              Int64
dtype: object
  province_norm  year
0           nan  2000
1      a coruna  2003
2      a coruna  2004
3      a coruna  2005
4      a coruna  2006

Unique years in rates (sample): [2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011]</code></pre>
</div>
</div>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="neteja_i_preparacio_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="neteja_i_preparacio_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>